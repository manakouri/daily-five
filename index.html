<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Five</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F9F9F7;
        }
        /* Custom style to ensure SVGs scale correctly within their containers */
        .question-box svg {
            width: 100%;
            height: auto;
            max-height: 200px; /* Prevents SVGs from becoming too large */
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <div id="app-container" class="min-h-screen flex flex-col items-center justify-center p-4 sm:p-6 lg:p-8">
        
        <!-- Main content area -->
        <main id="main-content" class="w-full max-w-7xl mx-auto">
            <header class="text-center mb-6">
                <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 tracking-tight">Daily Five</h1>
                <p class="mt-2 text-base text-gray-600">A new set of daily math questions.</p>
            </header>

            <!-- Questions Grid -->
            <div id="questions-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
                <!-- Question boxes will be inserted here by JavaScript -->
            </div>
            
            <!-- Action Buttons -->
            <div class="mt-8 flex flex-col sm:flex-row items-center justify-center gap-4">
                <button id="generate-btn" class="w-full sm:w-auto bg-blue-600 text-white font-semibold py-3 px-8 rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-transform transform hover:scale-105">
                    Generate New Set
                </button>
                <button id="answers-btn" class="w-full sm:w-auto bg-gray-200 text-gray-800 font-semibold py-3 px-8 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400 transition-transform transform hover:scale-105">
                    Show Answers
                </button>
            </div>

            <!-- Answers Section (Initially Hidden) -->
            <div id="answers-container" class="hidden mt-8 max-w-3xl mx-auto bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-bold text-center mb-4">Answers</h2>
                <ol id="answers-list" class="list-decimal list-inside space-y-2 text-lg">
                    <!-- Answers will be inserted here -->
                </ol>
            </div>

        </main>
    </div>

    <script>
        // --- DOM Elements ---
        const questionsGrid = document.getElementById('questions-grid');
        const generateBtn = document.getElementById('generate-btn');
        const answersBtn = document.getElementById('answers-btn');
        const answersContainer = document.getElementById('answers-container');
        const answersList = document.getElementById('answers-list');

        let currentAnswers = [];

        // --- Utility Functions ---
        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- Question Generation Functions ---
        const questionGenerators = {
            numberKnowledge: [
                () => {
                    const num = getRandomInt(10000, 99999);
                    const places = [1, 10, 100, 1000, 10000];
                    const placeIndex = getRandomInt(0, 4);
                    const placeValue = places[placeIndex];
                    const digit = Math.floor(num / placeValue) % 10;
                    const placeName = {1: 'ones', 10: 'tens', 100: 'hundreds', 1000: 'thousands', 10000: 'ten thousands'}[placeValue];
                    
                    return {
                        question: `In the number <strong>${num.toLocaleString()}</strong>, what is the value of the digit in the ${placeName} place?`,
                        answer: (digit * placeValue).toLocaleString()
                    };
                },
                () => {
                    const denominator = [4, 6, 8][getRandomInt(0, 2)];
                    const numerator = getRandomInt(1, denominator - 2);
                    return {
                        question: `What is <strong><sup>${numerator}</sup>&frasl;<sub>${denominator}</sub> + <sup>1</sup>&frasl;<sub>${denominator}</sub></strong>?`,
                        answer: `<sup>${numerator + 1}</sup>&frasl;<sub>${denominator}</sub>`
                    }
                },
                 () => {
                    const scenarios = [
                        { item: 'cake', action: 'cut into quarters', subAction: 'each quarter was cut in half', pieces: 8, unit: 'pieces' },
                        { item: 'pizza', action: 'cut into quarters', subAction: 'each quarter was cut in half', pieces: 8, unit: 'slices' },
                        { item: 'cake', action: 'cut in half', subAction: 'each half was cut into thirds', pieces: 6, unit: 'pieces' },
                        { item: 'pizza', action: 'cut in half', subAction: 'each half was cut into thirds', pieces: 6, unit: 'slices' },
                    ];
                    const scenario = scenarios[getRandomInt(0, scenarios.length - 1)];

                    return {
                        question: `A ${scenario.item} was ${scenario.action} and then ${scenario.subAction}. How many ${scenario.unit} of ${scenario.item} were there?`,
                        answer: `${scenario.pieces} ${scenario.unit}`
                    }
                },
                () => {
                    const num = getRandomInt(2000, 5000);
                    return {
                        question: `What number is 100 more than <strong>${num.toLocaleString()}</strong>?`,
                        answer: (num + 100).toLocaleString()
                    }
                },
                () => {
                    const tens = getRandomInt(15, 45);
                    return {
                        question: `How many $10 notes are in <strong>$${tens * 10}</strong>?`,
                        answer: `${tens}`
                    }
                },
                () => {
                    const timesTable = getRandomInt(3, 8);
                    const multiples = [timesTable * 2, timesTable * 3, timesTable * 4, timesTable * 5, timesTable * 6];
                    const outlierIndex = getRandomInt(2, 3);
                    const originalValue = multiples[outlierIndex];
                    let outlier;
                    do {
                        outlier = originalValue + getRandomInt(1, 3) * (getRandomInt(0, 1) === 0 ? 1 : -1);
                    } while (outlier % timesTable === 0); // Ensure the outlier is not another multiple
                    
                    multiples[outlierIndex] = outlier;

                    return {
                        question: `All of these numbers are multiples of <strong>${timesTable}</strong> except for one. Which one is it? <br><strong>${shuffleArray(multiples).join(', ')}</strong>`,
                        answer: outlier
                    };
                }
            ],
            algebra: [
                () => {
                    const start = getRandomInt(1, 10);
                    const step = getRandomInt(2, 9);
                    const sequence = [start, start + step, start + step * 2].join(', ');
                    const nextNum = start + step * 3;
                    return {
                        question: `Continue the number pattern: <strong>${sequence}, ...</strong> What is the next number?`,
                        answer: nextNum
                    };
                },
                 () => {
                    const num1 = getRandomInt(2, 10);
                    const num2 = getRandomInt(2, 10);
                    const num3 = getRandomInt(2, 10);
                    const answer = num3 + num2 - num1;
                    return {
                        question: `Find the value of the square: <strong>${num1} + &#9633; = ${num3} + ${num2}</strong>`,
                        answer: answer
                    }
                },
                () => {
                    const a = getRandomInt(2, 9);
                    const b = getRandomInt(10, 25);
                    const sum = a + b;
                    const operators = ['+', '-', '&times;', '&div;'];
                    const correctAnswer = '+';
                    return {
                        question: `If <strong>${a} + ${b} = ${sum}</strong>, then which symbol goes in the box? <br><strong>${sum} = ${b} [ &#9633; ] ${a}</strong> <br>(${operators.join(', ')})`,
                        answer: correctAnswer
                    };
                },
                () => {
                    const unknown = getRandomInt(2, 6);
                    const num1 = unknown * getRandomInt(1, 4);
                    const num2 = unknown * getRandomInt(5, 10);
                    return {
                        question: `If <strong>${num1} &div; &#9633; = ${num1/unknown}</strong>, then what is <strong>${num2} &div; &#9633;</strong>?`,
                        answer: num2 / unknown
                    }
                },
                () => {
                    const addend1 = getRandomInt(20, 50);
                    const sum = getRandomInt(addend1 + 10, 99);
                    return {
                        question: `Find the missing number: <strong>${addend1} + &#9633; = ${sum}</strong>`,
                        answer: sum - addend1
                    }
                },
                 () => {
                    const start = getRandomInt(1, 10);
                    const step = getRandomInt(2, 9);
                    const sequence = [start, start + step, start + step * 2, start + step * 3, start + step * 4];
                    const missingIndex = getRandomInt(1, 3);
                    const answer = sequence[missingIndex];
                    sequence[missingIndex] = '___';
                    
                    return {
                        question: `Find the missing number in the pattern: <strong>${sequence.join(', ')}</strong>`,
                        answer: answer
                    };
                }
            ],
            statistics: [
                () => {
                    const sets = [
                        { context: 'pets', items: ['Cats', 'Dogs', 'Fish'] },
                        { context: 'subjects', items: ['Maths', 'Reading', 'Art'] },
                        { context: 'seasons', items: ['Summer', 'Winter', 'Autumn'] }
                    ];
                    const chosenSet = sets[getRandomInt(0, sets.length - 1)];

                    const total = [40, 50, 60, 80, 100][getRandomInt(0, 4)];
                    const percentCombinations = [
                        [10, 20, 70], [10, 30, 60], [10, 40, 50],
                        [20, 20, 60], [20, 30, 50], [20, 40, 40],
                        [30, 30, 40]
                    ];

                    const chosenPercents = shuffleArray(percentCombinations[getRandomInt(0, percentCombinations.length - 1)]);

                    const data = [
                        { label: chosenSet.items[0], percent: chosenPercents[0], color: '#60a5fa' },
                        { label: chosenSet.items[1], percent: chosenPercents[1], color: '#4ade80' },
                        { label: chosenSet.items[2], percent: chosenPercents[2], color: '#fb923c' }
                    ];

                    data.forEach(item => { item.count = (item.percent / 100) * total; });
                    const targetItem = data[getRandomInt(0, data.length - 1)];
                    const cx = 160; const cy = 60; const r = 50;
                    let startAngle = -90;

                    const paths = data.map(item => {
                        const angle = (item.percent / 100) * 360;
                        const endAngle = startAngle + angle;
                        const x1 = cx + r * Math.cos(startAngle * Math.PI / 180);
                        const y1 = cy + r * Math.sin(startAngle * Math.PI / 180);
                        const x2 = cx + r * Math.cos(endAngle * Math.PI / 180);
                        const y2 = cy + r * Math.sin(endAngle * Math.PI / 180);
                        const largeArcFlag = angle > 180 ? 1 : 0;
                        const d = `M ${cx},${cy} L ${x1},${y1} A ${r},${r} 0 ${largeArcFlag} 1 ${x2},${y2} Z`;
                        startAngle = endAngle;
                        return `<path d="${d}" fill="${item.color}" stroke="white" stroke-width="1.5"></path>`;
                    }).join('');
                    
                    const legend = data.map((item, i) => 
                        `<rect x="10" y="${25 + i * 20}" width="10" height="10" fill="${item.color}"></rect>
                         <text x="25" y="${34 + i * 20}" font-size="11" fill="black">${item.label}: ${item.percent}%</text>`
                    ).join('');

                    const svg = `<svg viewBox="0 0 220 120" class="mx-auto mt-4">${paths}${legend}</svg>`;
                    
                    return {
                        question: `A survey of <strong>${total}</strong> students asked for their favourite ${chosenSet.context}. Based on the chart, how many students chose ${targetItem.label}?`,
                        svg: svg,
                        answer: targetItem.count
                    };
                },
                () => {
                    const sets = [
                        { context: 'sports', items: ['Soccer', 'Rugby', 'Tennis', 'Cricket'] },
                        { context: 'fruits', items: ['Apple', 'Banana', 'Orange', 'Grape'] },
                        { context: 'flavours', items: ['Choc', 'Vanilla', 'Berry', 'Mint'] }
                    ];
                    const chosenSet = sets[getRandomInt(0, sets.length - 1)];

                    const data = [
                        { label: chosenSet.items[0], count: getRandomInt(5, 20) },
                        { label: chosenSet.items[1], count: getRandomInt(5, 20) },
                        { label: chosenSet.items[2], count: getRandomInt(5, 20) },
                        { label: chosenSet.items[3], count: getRandomInt(5, 20) },
                    ];
                    
                    // Sort to easily find min/max, and adjust to avoid ties
                    data.sort((a,b) => a.count - b.count);
                    if (data[0].count === data[1].count) {
                        data[0].count = Math.max(1, data[0].count - 1);
                    }
                     if (data[3].count === data[2].count) {
                        data[3].count += 1;
                    }
                    data.sort((a,b) => a.count - b.count);

                    const maxVal = data[3].count;
                    const mostPopular = data[3].label;
                    const leastPopular = data[0].label;
                    const totalStudents = data.reduce((sum, d) => sum + d.count, 0);

                    const singularContext = chosenSet.context.slice(0, -1); // E.g., 'sports' becomes 'sport'
                    const questionTypes = [
                        { question: `How many students were surveyed in total?`, answer: totalStudents },
                        { question: `Which ${singularContext} was the most popular?`, answer: mostPopular },
                        { question: `Which ${singularContext} was the least popular?`, answer: leastPopular }
                    ];
                    
                    const chosenQuestion = questionTypes[getRandomInt(0, questionTypes.length - 1)];

                    const bars = data.map((item, i) => {
                        const barHeight = (item.count / (maxVal + 2)) * 80; // Add padding to max val
                        return `<g transform="translate(${20 + i * 45}, 0)">
                                    <rect y="${100 - barHeight}" width="30" height="${barHeight}" fill="#60a5fa"></rect>
                                    <text x="15" y="115" text-anchor="middle" font-size="10">${item.label}</text>
                                    <text x="15" y="${95 - barHeight}" text-anchor="middle" font-size="10" fill="black">${item.count}</text>
                                </g>`;
                    }).join('');
                    const svg = `<svg viewBox="0 0 200 120" class="mx-auto mt-4">${bars}</svg>`;
                    
                    return {
                        question: `The bar chart shows the favourite ${chosenSet.context} of a group of students. ${chosenQuestion.question}`,
                        svg: svg,
                        answer: chosenQuestion.answer
                    };
                },
                 () => {
                    const players = [
                        {name: 'Sam', goals: getRandomInt(3, 8)}, {name: 'Jen', goals: getRandomInt(3, 8)},
                        {name: 'Mo', goals: getRandomInt(3, 8)}, {name: 'Li', goals: getRandomInt(3, 8)},
                    ].sort((a,b) => a.goals - b.goals);

                    const threshold = players[getRandomInt(1,2)].goals;
                    const playersBelow = players.filter(p => p.goals < threshold).length;
                    
                    let table = `<table class="w-full text-center mt-4 border-collapse"><thead><tr><th class="border p-2">Player</th><th class="border p-2">Goals</th></tr></thead><tbody>`;
                    players.forEach(p => { table += `<tr><td class="border p-2">${p.name}</td><td class="border p-2">${p.goals}</td></tr>`; });
                    table += `</tbody></table>`;
                    
                    return {
                        question: `Using the frequency table, how many players scored fewer than <strong>${threshold} goals</strong>? ${table}`,
                        answer: playersBelow
                    };
                }
            ],
            numberStrategies: [
                () => {
                    const scenarios = [
                        {
                            setup: (count) => `One whetū (star) is made from ${count} strips of harakeke (flax).`,
                            query: (total) => `How many whetū will <strong>${total}</strong> strips of harakeke make?`,
                            answerUnit: 'whetū'
                        },
                        {
                            setup: (count) => `One bag can hold ${count} jellybeans.`,
                            query: (total) => `How many bags will <strong>${total}</strong> jellybeans fill?`,
                            answerUnit: 'bags'
                        },
                        {
                            setup: (count) => `One shelf can hold ${count} boxes of Weet-Bix.`,
                            query: (total) => `How many shelves will <strong>${total}</strong> boxes of Weet-Bix fill?`,
                            answerUnit: 'shelves'
                        }
                    ];
                    
                    const scenario = scenarios[getRandomInt(0, scenarios.length - 1)];
                    const itemsPerUnit = getRandomInt(2, 9);
                    const totalItems = itemsPerUnit * getRandomInt(5, 15);

                    return {
                        question: `${scenario.setup(itemsPerUnit)} ${scenario.query(totalItems)}`,
                        answer: `${totalItems / itemsPerUnit} ${scenario.answerUnit}`
                    };
                },
                 () => {
                    const coveredRows = getRandomInt(3, 8);
                    const coveredCols = getRandomInt(3, 8);
                    const coveredCount = coveredRows * coveredCols;
                    
                    let beads = '';
                    for (let r = 0; r < 10; r++) {
                        for (let c = 0; c < 10; c++) {
                            const isCovered = r < coveredRows && c < coveredCols;
                            beads += `<circle cx="${10 + c * 10}" cy="${10 + r * 10}" r="4" fill="${isCovered ? '#a1a1aa' : '#ef4444'}" />`;
                        }
                    }
                    const cover = `<rect x="4" y="4" width="${coveredCols * 10}" height="${coveredRows * 10}" fill="#d4d4d8" stroke="#71717a" stroke-width="1" />`;
                    const svg = `<svg viewBox="0 0 110 110" class="mx-auto mt-4">${beads}${cover}</svg>`;

                    return {
                        question: `There are 100 beads on the frame. How many have been covered up?`,
                        svg: svg,
                        answer: `${coveredCount} beads`
                    }
                },
                () => {
                    const scenarios = [
                        { item1: 'ice creams', item2: 'chocolate bars', num1: 2, num2: 3, comparison: 'costs less than' },
                        { item1: 'cheetahs', item2: 'racehorses', num1: 1, num2: 2, comparison: 'is slower than' },
                        { item1: 'watermelons', item2: 'apples', num1: 1, num2: 8, comparison: 'weighs less than' }
                    ];
                    const scenario = scenarios[getRandomInt(0, scenarios.length - 1)];
                    const singularItem2 = scenario.item2.slice(0,-1);

                    return {
                        question: `True or False: If ${scenario.num1} ${scenario.item1} are the same price/speed/weight as ${scenario.num2} ${scenario.item2}, then a single ${singularItem2} ${scenario.comparison} a single ${scenario.item1.slice(0,-1)}.`,
                        answer: 'True'
                    };
                },
                () => {
                    const scenarios = [
                        { name: 'Jamal', action: 'making a necklace', item1: 'spotty beads', item2: 'stripey beads' },
                        { name: 'Sofia', action: 'building a Lego tower', item1: 'square blocks', item2: 'rectangle blocks' },
                        { name: 'Amira', action: 'making fruit kebabs', item1: 'strawberries', item2: 'pieces of banana' }
                    ];
                    const scenario = scenarios[getRandomInt(0, scenarios.length - 1)];
                    
                    const ratio1 = getRandomInt(2,4);
                    const ratio2 = getRandomInt(ratio1 + 1, 7);
                    const multiplier = getRandomInt(3, 7);
                    const num1 = ratio1 * multiplier;
                    const num2 = ratio2 * multiplier;

                    return {
                        question: `${scenario.name} is ${scenario.action}. They use ${ratio1} ${scenario.item1} for every ${ratio2} ${scenario.item2}. If they use <strong>${num1} ${scenario.item1}</strong>, how many ${scenario.item2} will they need?`,
                        answer: `${num2} ${scenario.item2}`
                    }
                },
                () => {
                    const num1 = getRandomInt(800, 950);
                    const num2 = getRandomInt(600, 790);
                    const num3 = getRandomInt(100, 250);
                    return {
                        question: `What is <strong>${num1} + ${num2} + ${num3}</strong>?`,
                        answer: (num1 + num2 + num3).toLocaleString()
                    }
                },
                () => {
                    const num1 = getRandomInt(25, 49);
                    const num2 = getRandomInt(25, 49);
                    const num3 = getRandomInt(25, 49);
                    return {
                        question: `A farmer collected ${num1} eggs on Monday, ${num2} on Tuesday, and ${num3} on Wednesday. How many eggs were collected in total?`,
                        answer: num1 + num2 + num3
                    }
                }
            ],
            geometryMeasurement: [
                () => {
                    const hour = getRandomInt(1, 12);
                    const minute = getRandomInt(0, 11) * 5;
                    const hourAngle = (hour % 12 + minute / 60) * 30;
                    const minuteAngle = minute * 6;
                    
                    let markers = '';
                    for (let i = 1; i <= 12; i++) {
                        const angle = i * 30 * Math.PI / 180;
                        const x = 50 + 40 * Math.sin(angle);
                        const y = 50 - 40 * Math.cos(angle);
                        markers += `<text x="${x}" y="${y+3}" text-anchor="middle" font-size="8">${i}</text>`;
                    }

                    const svg = `<svg viewBox="0 0 100 100" class="mx-auto mt-4">
                                    <circle cx="50" cy="50" r="45" stroke="black" fill="white" />
                                    ${markers}
                                    <line x1="50" y1="50" x2="${50 + 25 * Math.sin(hourAngle * Math.PI / 180)}" y2="${50 - 25 * Math.cos(hourAngle * Math.PI / 180)}" stroke="black" stroke-width="3" />
                                    <line x1="50" y1="50" x2="${50 + 35 * Math.sin(minuteAngle * Math.PI / 180)}" y2="${50 - 35 * Math.cos(minuteAngle * Math.PI / 180)}" stroke="black" stroke-width="2" />
                                    <circle cx="50" cy="50" r="3" fill="black" />
                                </svg>`;
                    
                    return {
                        question: `What time is shown on the clock?`,
                        svg: svg,
                        answer: `${hour}:${minute.toString().padStart(2, '0')}`
                    }
                },
                 () => {
                    const length = (getRandomInt(1, 8) + getRandomInt(0,1) * 0.5 + 2).toFixed(1);
                    const scaleFactor = 20;
                    let markings = '';
                    for(let i=0; i<=10; i++){
                        markings += `<line x1="${10 + i * scaleFactor}" y1="40" x2="${10 + i * scaleFactor}" y2="${i%2===0 ? 30:35}" stroke="black" />`;
                        if(i%2===0) markings += `<text x="${10 + i * scaleFactor}" y="25" text-anchor="middle" font-size="8">${i}</text>`;
                    }
                    const svg = `<svg viewBox="0 0 235 60" class="mx-auto mt-4">
                                    <rect x="10" y="45" width="${length * scaleFactor}" height="10" fill="#fca5a5" />
                                    <line x1="10" y1="40" x2="210" y2="40" stroke="black" />
                                    ${markings}
                                    <text x="222" y="40" font-size="8" dominant-baseline="middle">cm</text>
                                </svg>`;

                    return {
                        question: 'How long is the red bar in centimetres?',
                        svg: svg,
                        answer: `${length} cm`
                    };
                },
                () => {
                    const ml = getRandomInt(1,4) * 5 + 50;
                    let markings = '';
                    for(let i=0; i <= 100; i+=10) {
                        markings += `<line x1="45" y1="${120-i}" x2="55" y2="${120-i}" stroke="black" />`;
                        markings += `<text x="38" y="${124-i}" font-size="8" text-anchor="end">${i}</text>`;
                    }
                     for(let i=5; i <= 95; i+=10) {
                        markings += `<line x1="48" y1="${120-i}" x2="52" y2="${120-i}" stroke="black" />`;
                    }
                    const svg = `<svg viewBox="0 0 100 140" class="mx-auto mt-4">
                                    <rect x="55" y="${120-ml}" width="20" height="${ml}" fill="#67e8f9"/>
                                    <path d="M 50 120 L 50 10 L 80 10 L 80 120" stroke="black" fill="none"/>
                                    ${markings}
                                    <text x="75" y="130" font-size="10">ml</text>
                                </svg>`;
                    return {
                        question: 'How much liquid is in the measuring cup?',
                        svg: svg,
                        answer: `${ml} ml`
                    }
                },
                () => {
                    const width = getRandomInt(5, 8);
                    const height = getRandomInt(3, 5);
                    const units = [
                        { name: 'centimetre', symbol: 'cm²' },
                        { name: 'metre', symbol: 'm²' }
                    ];
                    const chosenUnit = units[getRandomInt(0, units.length - 1)];

                    let grid = '';
                    for (let i = 0; i < height; i++) {
                        for (let j = 0; j < width; j++) {
                            grid += `<rect x="${j * 20}" y="${i * 20}" width="20" height="20" stroke="gray" fill="#a7f3d0"/>`;
                        }
                    }
                    const svg = `<svg viewBox="-1 -1 162 102" class="mx-auto mt-4">${grid}</svg>`;
                    return {
                        question: `Each square in the shape below represents one square <strong>${chosenUnit.name}</strong>. What is the total area of the shape?`,
                        svg: svg,
                        answer: `${width * height} ${chosenUnit.symbol}`
                    };
                }
            ]
        };

        // --- Main App Logic ---
        function generateQuestions() {
            // Clear previous questions and answers
            questionsGrid.innerHTML = '';
            answersList.innerHTML = '';
            answersContainer.classList.add('hidden');
            answersBtn.textContent = 'Show Answers';
            currentAnswers = [];
            
            // Get one question from each category
            let questions = [];
            for (const category in questionGenerators) {
                const categoryGenerators = questionGenerators[category];
                const generator = categoryGenerators[getRandomInt(0, categoryGenerators.length - 1)];
                questions.push(generator());
            }

            // Shuffle the order of questions
            questions = shuffleArray(questions);
            
            // Display questions and store answers
            questions.forEach((q, index) => {
                const questionBox = document.createElement('div');
                questionBox.className = 'question-box bg-white p-5 rounded-xl shadow-sm border border-gray-200 flex flex-col justify-between';
                
                const questionText = `<p class="text-lg leading-relaxed"><strong class="mr-2">${index + 1}.</strong>${q.question}</p>`;
                const svgContent = q.svg ? q.svg : '';

                questionBox.innerHTML = `
                    <div>
                        ${questionText}
                        <div class="w-full flex justify-center mt-4">
                            ${svgContent}
                        </div>
                    </div>
                `;
                questionsGrid.appendChild(questionBox);
                currentAnswers.push(q.answer);
            });
        }

        function toggleAnswers() {
            const isHidden = answersContainer.classList.toggle('hidden');
            if (isHidden) {
                answersBtn.textContent = 'Show Answers';
            } else {
                answersBtn.textContent = 'Hide Answers';
                answersList.innerHTML = ''; // Clear old answers
                currentAnswers.forEach(answer => {
                    const li = document.createElement('li');
                    li.innerHTML = answer;
                    answersList.appendChild(li);
                });
            }
        }

        // --- Event Listeners ---
        generateBtn.addEventListener('click', generateQuestions);
        answersBtn.addEventListener('click', toggleAnswers);

        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', generateQuestions);

    </script>

</body>
</html>



